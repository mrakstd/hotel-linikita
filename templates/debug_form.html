<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ª–∞–¥–∫–∞ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f8f9fa; }
        .container { max-width: 800px; margin: 0 auto; }
        .card { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        select, input, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .debug-info { background: #e9ecef; padding: 15px; border-radius: 4px; margin: 10px 0; font-family: monospace; font-size: 12px; }
        .success { background: #d4edda; color: #155724; padding: 10px; border-radius: 4px; margin: 10px 0; }
        .error { background: #f8d7da; color: #721c24; padding: 10px; border-radius: 4px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß –û—Ç–ª–∞–¥–∫–∞ —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á</h1>
        
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <div class="card">
            <h2>–§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏</h2>
            <form method="POST" action="{{ url_for('create_task') }}" onsubmit="return debugForm(this)">
                <div class="form-group">
                    <label for="room_id">–ù–æ–º–µ—Ä –∫–æ–º–Ω–∞—Ç—ã:</label>
                    <select name="room_id" id="room_id" required>
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä --</option>
                        <option value="1">101 (Standard)</option>
                        <option value="2">102 (Standard)</option>
                        <option value="3">201 (Deluxe)</option>
                        <option value="4">202 (Deluxe)</option>
                        <option value="5">301 (Suite)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="task_type">–¢–∏–ø –∑–∞–¥–∞—á–∏:</label>
                    <select name="task_type" id="task_type" required>
                        <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø --</option>
                        <option value="cleaning">–£–±–æ—Ä–∫–∞</option>
                        <option value="maintenance">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</option>
                        <option value="inspection">–ü—Ä–æ–≤–µ—Ä–∫–∞</option>
                        <option value="other">–î—Ä—É–≥–æ–µ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                    <textarea name="description" id="description" rows="3" placeholder="–û–ø–∏—à–∏—Ç–µ –∑–∞–¥–∞—á—É..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="assigned_to">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:</label>
                    <input type="text" name="assigned_to" id="assigned_to" placeholder="–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞">
                </div>
                
                <button type="submit">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
            </form>
        </div>
        
        <div class="card">
            <h2>–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
            <div class="debug-info">
                <strong>URL —Ñ–æ—Ä–º—ã:</strong> {{ url_for('create_task') }}<br>
                <strong>–ú–µ—Ç–æ–¥:</strong> POST<br>
                <strong>–¢–µ–∫—É—â–∏–π URL:</strong> {{ request.url }}<br>
                <strong>User Agent:</strong> {{ request.headers.get('User-Agent', '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω') }}<br>
            </div>
            
            <div id="form-debug" class="debug-info" style="display: none;">
                <strong>–î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –∑–¥–µ—Å—å –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π</strong>
            </div>
        </div>
        
        <div class="card">
            <h2>–°—Å—ã–ª–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
            <p><a href="{{ url_for('tasks') }}">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∑–∞–¥–∞—á–∞–º</a></p>
            <p><a href="{{ url_for('simple_task_form') }}">–ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞</a></p>
            <p><a href="{{ url_for('test_tasks') }}">–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</a></p>
        </div>
    </div>
    
    <script>
        function debugForm(form) {
            const formData = new FormData(form);
            const debugDiv = document.getElementById('form-debug');
            
            let debugText = '–î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π:\n';
            for (let [key, value] of formData.entries()) {
                debugText += `${key}: "${value}"\n`;
            }
            
            debugDiv.innerHTML = '<pre>' + debugText + '</pre>';
            debugDiv.style.display = 'block';
            
            console.log('–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã —Å –¥–∞–Ω–Ω—ã–º–∏:', Object.fromEntries(formData));
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º true, —á—Ç–æ–±—ã —Ñ–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–∏–ª–∞—Å—å
            return true;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ JavaScript —Ä–∞–±–æ—Ç–∞–µ—Ç
        console.log('–û—Ç–ª–∞–¥–æ—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, —Ñ–æ—Ä–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ');
        });
    </script>
</body>
</html>