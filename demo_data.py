# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Hotel Management System
# –ê–≤—Ç–æ—Ä: –õ–∏ –ù–∏–∫–∏—Ç–∞

import sqlite3
from datetime import datetime, timedelta

def add_demo_data():
    """–î–æ–±–∞–≤–ª—è–µ—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã"""
    conn = sqlite3.connect('hotel_system.db')
    c = conn.cursor()
    
    # –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞
    additional_rooms = [
        ('103', 'Standard', 'available', 350000.00),
        ('104', 'Standard', 'cleaning', 350000.00),
        ('203', 'Deluxe', 'available', 500000.00),
        ('204', 'Deluxe', 'occupied', 500000.00),
        ('302', 'Suite', 'maintenance', 750000.00),
        ('303', 'Suite', 'available', 750000.00),
        ('401', 'Presidential', 'available', 1200000.00)
    ]
    
    for room in additional_rooms:
        try:
            c.execute('INSERT INTO rooms (room_number, room_type, status, price) VALUES (?, ?, ?, ?)', room)
        except sqlite3.IntegrityError:
            pass  # –ù–æ–º–µ—Ä —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    
    # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –≥–æ—Å—Ç–µ–π
    demo_guests = [
        ('–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á', '+998 (90) 123-45-67', 'petrov@email.com', 2, '2024-01-08', '2024-01-12'),
        ('–°–∏–¥–æ—Ä–æ–≤–∞ –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–Ω–∞', '+998 (91) 234-56-78', 'sidorova@email.com', 8, '2024-01-07', '2024-01-10'),
        ('–ò–≤–∞–Ω–æ–≤ –ê–ª–µ–∫—Å–µ–π –°–µ—Ä–≥–µ–µ–≤–∏—á', '+998 (93) 345-67-89', 'ivanov@gmail.com', 4, '2024-01-06', '2024-01-11'),
        ('–ö–æ–∑–ª–æ–≤–∞ –ú–∞—Ä–∏—è –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞', '+998 (94) 456-78-90', 'kozlova@mail.ru', 11, '2024-01-08', '2024-01-15'),
        ('–°–º–∏—Ä–Ω–æ–≤ –î–º–∏—Ç—Ä–∏–π –í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á', '+998 (95) 567-89-01', 'smirnov@yandex.ru', 1, '2024-01-05', '2024-01-09'),
        ('–ù–æ–≤–∏–∫–æ–≤–∞ –ï–ª–µ–Ω–∞ –ú–∏—Ö–∞–π–ª–æ–≤–Ω–∞', '+998 (97) 678-90-12', 'novikova@outlook.com', 3, '2024-01-07', '2024-01-14'),
        ('–í–æ–ª–∫–æ–≤ –ê–Ω–¥—Ä–µ–π –ù–∏–∫–æ–ª–∞–µ–≤–∏—á', '+998 (98) 789-01-23', 'volkov@hotmail.com', 5, '2024-01-06', '2024-01-13'),
        ('–ú–æ—Ä–æ–∑–æ–≤–∞ –û–ª—å–≥–∞ –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞', '+998 (99) 890-12-34', 'morozova@gmail.com', 7, '2024-01-08', '2024-01-12'),
        ('–§–µ–¥–æ—Ä–æ–≤ –ò–≥–æ—Ä—å –ê–Ω–∞—Ç–æ–ª—å–µ–≤–∏—á', '+998 (90) 901-23-45', 'fedorov@mail.uz', 9, '2024-01-05', '2024-01-10'),
        ('–õ–µ–±–µ–¥–µ–≤–∞ –¢–∞—Ç—å—è–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞', '+998 (91) 012-34-56', 'lebedeva@bk.ru', 10, '2024-01-07', '2024-01-16'),
    ]
    
    for guest in demo_guests:
        try:
            c.execute('''INSERT INTO guests (name, phone, email, room_id, check_in, check_out) 
                        VALUES (?, ?, ?, ?, ?, ?)''', guest)
        except sqlite3.IntegrityError:
            pass
    
    # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
    demo_tasks = [
        (1, 'cleaning', '–ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –≥–æ—Å—Ç—è', 'pending', '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞'),
        (3, 'maintenance', '–ó–∞–º–µ–Ω–∞ –ª–∞–º–ø–æ—á–∫–∏ –≤ –≤–∞–Ω–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ', 'in_progress', '–°–µ—Ä–≥–µ–π –ü–µ—Ç—Ä–æ–≤'),
        (5, 'inspection', '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞ –ø–µ—Ä–µ–¥ –∑–∞—Å–µ–ª–µ–Ω–∏–µ–º VIP –≥–æ—Å—Ç—è', 'completed', '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞'),
        (7, 'cleaning', '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —É–±–æ—Ä–∫–∞', 'pending', '–û–ª—å–≥–∞ –ö–æ–∑–ª–æ–≤–∞'),
        (9, 'maintenance', '–†–µ–º–æ–Ω—Ç —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏', 'in_progress', '–ò–≤–∞–Ω –°–º–∏—Ä–Ω–æ–≤'),
        (2, 'cleaning', '–£–±–æ—Ä–∫–∞ –ø–æ—Å–ª–µ –≤—ã—Å–µ–ª–µ–Ω–∏—è', 'completed', '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞'),
        (4, 'maintenance', '–ó–∞–º–µ–Ω–∞ –ø–æ–ª–æ—Ç–µ–Ω–µ—Ü –∏ –ø–æ—Å—Ç–µ–ª—å–Ω–æ–≥–æ –±–µ–ª—å—è', 'pending', '–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞'),
        (6, 'inspection', '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞', 'in_progress', '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞'),
        (8, 'cleaning', '–í–ª–∞–∂–Ω–∞—è —É–±–æ—Ä–∫–∞ –∏ –¥–µ–∑–∏–Ω—Ñ–µ–∫—Ü–∏—è', 'pending', '–û–ª—å–≥–∞ –ö–æ–∑–ª–æ–≤–∞'),
        (10, 'maintenance', '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞', 'completed', '–°–µ—Ä–≥–µ–π –ü–µ—Ç—Ä–æ–≤'),
        (11, 'cleaning', '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–æ–º–µ—Ä–∞ –∫ –∑–∞—Å–µ–ª–µ–Ω–∏—é', 'in_progress', '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞'),
        (12, 'inspection', '–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ —É–±–æ—Ä–∫–∏', 'pending', '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞'),
    ]
    
    for task in demo_tasks:
        try:
            c.execute('''INSERT INTO tasks (room_id, task_type, description, status, assigned_to) 
                        VALUES (?, ?, ?, ?, ?)''', task)
        except sqlite3.IntegrityError:
            pass
    
    # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
    demo_quality_checks = [
        (1, 9, 8, 9, '–û—Ç–ª–∏—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –≤—Å–µ —á–∏—Å—Ç–æ', '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞'),
        (2, 7, 9, 8, '–ù–µ–±–æ–ª—å—à–∏–µ –ø—è—Ç–Ω–∞ –Ω–∞ –∫–æ–≤—Ä–µ, –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Ö–æ—Ä–æ—à–æ', '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞'),
        (3, 10, 10, 9, '–ò–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–æ–º–µ—Ä–∞', '–û–ª—å–≥–∞ –ö–æ–∑–ª–æ–≤–∞'),
        (4, 8, 7, 6, '–¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–º–µ–Ω–∞ –ø–æ–ª–æ—Ç–µ–Ω–µ—Ü, –ø—Ä–æ–±–ª–µ–º—ã —Å –∫—Ä–∞–Ω–æ–º', '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞'),
        (5, 9, 9, 10, '–ù–æ–º–µ—Ä –≤ –æ—Ç–ª–∏—á–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏', '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞'),
        (6, 8, 8, 8, '–•–æ—Ä–æ—à–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –º–µ–ª–∫–∏–µ –Ω–µ–¥–æ—á–µ—Ç—ã', '–û–ª—å–≥–∞ –ö–æ–∑–ª–æ–≤–∞'),
        (7, 9, 7, 9, '–ß–∏—Å—Ç–æ, –Ω–æ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –º–∏–Ω–∏-–±–∞—Ä', '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞'),
        (8, 10, 9, 8, '–û—Ç–ª–∏—á–Ω–∞—è —É–±–æ—Ä–∫–∞, –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç', '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞'),
        (9, 6, 8, 7, '–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —É–±–æ—Ä–∫–∞ –≤–∞–Ω–Ω–æ–π', '–û–ª—å–≥–∞ –ö–æ–∑–ª–æ–≤–∞'),
        (10, 9, 10, 9, '–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–æ–º–µ—Ä–∞', '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞'),
        (11, 8, 9, 8, '–•–æ—Ä–æ—à–æ, –Ω–µ–±–æ–ª—å—à–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è –ø–æ –æ—Å–≤–µ—â–µ–Ω–∏—é', '–ï–ª–µ–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞'),
        (12, 10, 8, 10, '–ò–¥–µ–∞–ª—å–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞, –æ—Ç–ª–∏—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å', '–û–ª—å–≥–∞ –ö–æ–∑–ª–æ–≤–∞'),
    ]
    
    for check in demo_quality_checks:
        try:
            c.execute('''INSERT INTO quality_checks 
                        (room_id, cleanliness_score, amenities_score, maintenance_score, notes, checked_by) 
                        VALUES (?, ?, ?, ?, ?, ?)''', check)
        except sqlite3.IntegrityError:
            pass
    
    conn.commit()
    
    # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç—É—Å—ã –Ω–æ–º–µ—Ä–æ–≤ —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –≥–æ—Å—Ç—è–º–∏
    sync_room_statuses(c)
    
    conn.commit()
    conn.close()
    print("‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã!")
    print("üè® –°—Ç–∞—Ç—É—Å—ã –Ω–æ–º–µ—Ä–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å –≥–æ—Å—Ç—è–º–∏!")
    print("üè® –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏")

def sync_room_statuses(cursor):
    """–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –Ω–æ–º–µ—Ä–æ–≤ —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –≥–æ—Å—Ç—è–º–∏"""
    
    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –Ω–æ–º–µ—Ä–∞ —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –≥–æ—Å—Ç—è–º–∏
    occupied_rooms = cursor.execute('''
        SELECT DISTINCT room_id 
        FROM guests 
        WHERE status = 'active'
    ''').fetchall()
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å 'occupied' –¥–ª—è –Ω–æ–º–µ—Ä–æ–≤ —Å –≥–æ—Å—Ç—è–º–∏
    for room in occupied_rooms:
        cursor.execute('''
            UPDATE rooms 
            SET status = 'occupied' 
            WHERE id = ?
        ''', (room[0],))
    
    # –ü–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä–∞ –±–µ–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ occupied
    empty_occupied_rooms = cursor.execute('''
        SELECT r.id 
        FROM rooms r 
        LEFT JOIN guests g ON r.id = g.room_id AND g.status = 'active'
        WHERE r.status = 'occupied' AND g.id IS NULL
    ''').fetchall()
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å 'available' –¥–ª—è –ø—É—Å—Ç—ã—Ö –Ω–æ–º–µ—Ä–æ–≤
    for room in empty_occupied_rooms:
        cursor.execute('''
            UPDATE rooms 
            SET status = 'available' 
            WHERE id = ?
        ''', (room[0],))
    
    print(f"üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ {len(occupied_rooms)} –∑–∞–Ω—è—Ç—ã—Ö –Ω–æ–º–µ—Ä–æ–≤")
    print(f"üîÑ –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ {len(empty_occupied_rooms)} –ø—É—Å—Ç—ã—Ö –Ω–æ–º–µ—Ä–æ–≤")

if __name__ == '__main__':
    add_demo_data()